<!DOCTYPE html>
<html lang="ko">
<head>
	<title>Pixi.js로 비내리는 효과 만들어보기</title>
	<meta charset="UTF-8">
	<meta name="description" content="">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=1920, user-scalable=no">
	<script src="js/pixi.dev.js"></script>
	<script src="js/TweenMax.js"></script>
	<script src="js/TimelineMax.js"></script>

	<style type="text/css">
		body {margin:0;padding:0;}
	</style>
</head>


<body>
	<div id="pixiview"></div>
	
	<script>	
		var width = 600;
		var height = 400;

		//스테이지를 만든다
		var stage = new PIXI.Stage(0x000000);

		//렌더링을 만든다
		var renderer = PIXI.autoDetectRenderer(width, height);

		//렌더링의 View를 html의 요소에 추가한다
		document.getElementById("pixiview").appendChild(renderer.view);

		// 画像からスプライトオブジェクトを作る
		var texture = PIXI.Texture.fromImage('images/snow2.png');
		var MAX_SNOW = 300;
		var snowimgs = [];

		// 雪。
		for(var cnt=0;cnt < MAX_SNOW;cnt ++){
		  snowimgs.push(new PIXI.Sprite(texture));
		  snowimgs[cnt].position.x = Math.random() * 600;
		  snowimgs[cnt].position.y = Math.random() * 400;
		  snowimgs[cnt].anchor.x = 0.5;
		  snowimgs[cnt].anchor.y = 0.5;
		  var base = Math.random();
		  snowimgs[cnt].alpha = (base/2) + 0.4;
		  snowimgs[cnt].scale.x = base/2;
		  snowimgs[cnt].scale.y = base/2;
		  stage.addChild(snowimgs[cnt]);
		}

		// アニメーション関数を定義する
		function animate(){
			requestAnimFrame(animate); // 次の描画タイミングでanimateを呼び出す
			for(cnt=0;cnt <MAX_SNOW;cnt++){
				var scale = snowimgs[cnt].scale.x;
				snowimgs[cnt].position.x += scale * (Math.random() - 0.5) * 4;
				snowimgs[cnt].position.y += (scale * 3) + 1;
				if(snowimgs[cnt].position.y > 400){
					snowimgs[cnt].position.y = -10;
				}
			}
			renderer.render(stage);   // 描画する
		}

		// 次のアニメーションフレームでanimate()を呼び出してもらう
		requestAnimFrame(animate);

	</script>
</body>
</html>